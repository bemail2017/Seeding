<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project.exe</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="retro-header">
            <div class="title-bar">
                <div class="title-buttons">
                    <span class="button"></span>
                    <span class="button"></span>
                    <span class="button"></span>
                </div>
                <h1>Project.exe</h1>
            </div>
        </header>
        <nav class="menu-bar">
            <div class="menu-item" onclick="showContent('home')">Home</div>
            <div class="menu-item" onclick="toggleSubmenu('gamefi-menu')">
                GameFi
                <div id="gamefi-menu" class="submenu">
                    <div class="submenu-item" onclick="showContent('play2earn')">Play To Earn</div>
                    <div class="submenu-item" onclick="showContent('nft-games')">NFT Games</div>
                    <div class="submenu-item" onclick="showContent('defi-games')">DeFi Games</div>
                    <div class="submenu-separator"></div>
                    <div class="submenu-item" onclick="showContent('leaderboard')">Leaderboard</div>
                </div>
            </div>
            <div class="menu-item" onclick="toggleSubmenu('tool-menu')">
                Tool Auto
                <div id="tool-menu" class="submenu">
                    <div class="submenu-item" onclick="showContent('auto-claim')">Auto Claim</div>
                    <div class="submenu-item" onclick="showContent('auto-mint')">Auto Mint NFT</div>
                    <div class="submenu-item" onclick="showContent('auto-trade')">Auto Trade</div>
                    <div class="submenu-separator"></div>
                    <div class="submenu-item" onclick="showContent('bot-settings')">Bot Settings</div>
                </div>
            </div>
            <div class="menu-item" onclick="toggleSubmenu('airdrop-menu')">
                Airdrop
                <div id="airdrop-menu" class="submenu">
                    <div class="submenu-item" onclick="showAirdropContent('active')">Active Airdrops</div>
                    <div class="submenu-item" onclick="showAirdropContent('upcoming')">Upcoming</div>
                    <div class="submenu-item" onclick="showAirdropContent('ended')">Ended</div>
                    <div class="submenu-separator"></div>
                    <div class="submenu-item" onclick="showContent('my-airdrops')">My Airdrops</div>
                </div>
            </div>
            <div class="menu-item" onclick="toggleSubmenu('contact-menu')">
                Contact
                <div id="contact-menu" class="submenu">
                    <div class="submenu-item" onclick="showContent('message')">Send Message</div>
                    <div class="submenu-item" onclick="showContent('email')">Email Us</div>
                    <div class="submenu-separator"></div>
                    <div class="submenu-item" onclick="showContent('social')">Social Media</div>
                </div>
            </div>
            <div class="menu-item" onclick="toggleSubmenu('help-menu')">
                Help
                <div id="help-menu" class="submenu">
                    <div class="submenu-item" onclick="showContent('faq')">FAQ</div>
                    <div class="submenu-item" onclick="showContent('guide')">User Guide</div>
                    <div class="submenu-item" onclick="showContent('support')">Support</div>
                    <div class="submenu-separator"></div>
                    <div class="submenu-item" onclick="showContent('about')">About Us</div>
                </div>
            </div>
        </nav>
        <main class="content">
            <!-- Home section -->
            <div id="home" class="content-section">
                <div class="window">
                    <div class="window-header">
                        <span>Trang ch·ªß</span>
                        <button class="window-close">‚úï</button>
                    </div>
                    <div class="window-content">
                        <h2>Ch√†o m·ª´ng ƒë·∫øn v·ªõi Project.exe</h2>
                        <p>ƒê√¢y l√† trang t·ªïng quan v·ªÅ c√°c t√≠nh nƒÉng c·ªßa h·ªá th·ªëng.</p>
                    </div>
                </div>
            </div>

            <!-- GameFi section -->
            <div id="play2earn" class="content-section" style="display: none;">
                <div class="window">
                    <div class="window-header">
                        <span>Play To Earn Games</span>
                        <button class="window-close">‚úï</button>
                    </div>
                    <div class="window-content">
                        <h2>Danh s√°ch game P2E</h2>
                        <div class="game-list">
                            <!-- Game list will be added here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tool Auto section -->
            <div id="auto-claim" class="content-section" style="display: none;">
                <div class="window">
                    <div class="window-header">
                        <span>Auto Claim Tool</span>
                        <button class="window-close">‚úï</button>
                    </div>
                    <div class="window-content">
                        <div class="tool-container">
                            <div class="tool-settings">
                                <h3>C√†i ƒë·∫∑t</h3>
                                <form class="retro-form">
                                    <div class="form-group">
                                        <label>Network:</label>
                                        <select class="retro-input">
                                            <option>Ethereum</option>
                                            <option>BSC</option>
                                            <option>Polygon</option>
                                        </select>
                                    </div>
                                    <button class="retro-button">B·∫Øt ƒë·∫ßu</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Airdrop section -->
            <div id="airdrop-content" class="content-section" style="display: none;">
                <div class="window">
                    <div class="window-header">
                        <span>Danh s√°ch Airdrop</span>
                        <button class="window-close">‚úï</button>
                    </div>
                    <div class="window-content">
                        <div class="airdrop-toolbar">
                            <div class="filter-group">
                                <select id="statusFilter" class="retro-input">
                                    <option value="all">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                                    <option value="active">Active</option>
                                    <option value="upcoming">Upcoming</option>
                                    <option value="ended">Ended</option>
                                </select>
                                <select id="sortBy" class="retro-input">
                                    <option value="value">S·∫Øp x·∫øp theo gi√° tr·ªã</option>
                                    <option value="date">S·∫Øp x·∫øp theo ng√†y</option>
                                </select>
                            </div>
                            <div class="search-group">
                                <input type="text" id="searchInput" class="retro-input" placeholder="T√¨m ki·∫øm...">
                            </div>
                        </div>
                        <div id="airdrop-list" class="airdrop-grid"></div>
                        <div class="pagination">
                            <button class="retro-button" onclick="changePage(-1)">Tr∆∞·ªõc</button>
                            <span id="pageInfo">Trang 1</span>
                            <button class="retro-button" onclick="changePage(1)">Sau</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact section -->
            <div id="message" class="content-section" style="display: none;">
                <div class="window">
                    <div class="window-header">
                        <span>Li√™n h·ªá</span>
                        <button class="window-close">‚úï</button>
                    </div>
                    <div class="window-content">
                        <form class="retro-form">
                            <div class="form-group">
                                <label>T√™n:</label>
                                <input type="text" class="retro-input">
                            </div>
                            <div class="form-group">
                                <label>Email:</label>
                                <input type="email" class="retro-input">
                            </div>
                            <div class="form-group">
                                <label>N·ªôi dung:</label>
                                <textarea class="retro-input"></textarea>
                            </div>
                            <button class="retro-button">G·ª≠i</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Help section -->
            <div id="faq" class="content-section" style="display: none;">
                <div class="window">
                    <div class="window-header">
                        <span>Tr·ª£ gi√∫p</span>
                        <button class="window-close">‚úï</button>
                    </div>
                    <div class="window-content">
                        <h2>C√¢u h·ªèi th∆∞·ªùng g·∫∑p</h2>
                        <div class="faq-list">
                            <!-- FAQ items will be added here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ƒê√≥ng t·∫•t c·∫£ submenu
        function closeAllSubmenus() {
            const submenus = document.getElementsByClassName('submenu');
            for (let submenu of submenus) {
                submenu.style.display = 'none';
            }
        }

        // Toggle submenu
        function toggleSubmenu(menuId) {
            closeAllSubmenus();
            const submenu = document.getElementById(menuId);
            if (submenu.style.display === 'block') {
                submenu.style.display = 'none';
            } else {
                submenu.style.display = 'block';
            }
            event.stopPropagation();
        }

        // Hi·ªÉn th·ªã n·ªôi dung
        function showContent(sectionId) {
            const sections = document.getElementsByClassName('content-section');
            for (let section of sections) {
                section.style.display = 'none';
            }
            
            const section = document.getElementById(sectionId);
            if (section) {
                section.style.display = 'block';
            }
            
            closeAllSubmenus();
            event.stopPropagation();
        }

        // ƒê√≥ng submenu khi click ra ngo√†i
        document.addEventListener('click', function() {
            closeAllSubmenus();
        });

        // Show home content by default
        showContent('home');

        let allAirdrops = [];
        let currentPage = 1;
        const itemsPerPage = 12;

        async function loadAirdrops() {
            try {
                console.log('ƒêang t·∫£i d·ªØ li·ªáu t·ª´ Google Sheets...');
                
                // Th√™m CORS proxy
                const SHEET_ID = '15PsWPAhgBFiBqpnp0fjfJvyJjCcguPQOZiWKQRCyUg';
                const base = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?`;
                const query = encodeURIComponent('Select *');
                const url = `${base}&tq=${query}`;
                
                const response = await fetch(url);
                const text = await response.text();
                const data = JSON.parse(text.substring(47).slice(0, -2));
                
                // Chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu
                const headers = data.table.cols.map(col => col.label.toLowerCase());
                allAirdrops = data.table.rows.map(row => {
                    const project = {};
                    headers.forEach((header, index) => {
                        project[header] = row.c[index] ? row.c[index].v : '';
                    });
                    return project;
                });

                console.log('D·ªØ li·ªáu ƒë√£ t·∫£i:', allAirdrops);
                filterAirdrops();
                
            } catch (error) {
                console.error('L·ªói khi t·∫£i d·ªØ li·ªáu:', error);
                document.getElementById('airdrop-list').innerHTML = `
                    <div class="error-message">
                        <p>L·ªói khi t·∫£i d·ªØ li·ªáu: ${error.message}</p>
                        <p>Vui l√≤ng th·ª≠ l·∫°i sau</p>
                        <button class="retro-button" onclick="loadAirdrops()">Th·ª≠ l·∫°i</button>
                    </div>`;
            }
        }

        function filterAirdrops() {
            const statusFilter = document.getElementById('statusFilter').value;
            const sortBy = document.getElementById('sortBy').value;
            const searchText = document.getElementById('searchInput').value.toLowerCase();

            let filtered = [...allAirdrops];

            // L·ªçc theo tr·∫°ng th√°i
            if (statusFilter !== 'all') {
                filtered = filtered.filter(p => p.status.toLowerCase() === statusFilter);
            }

            // L·ªçc theo t√¨m ki·∫øm
            if (searchText) {
                filtered = filtered.filter(p => 
                    p.name.toLowerCase().includes(searchText) ||
                    p.description.toLowerCase().includes(searchText)
                );
            }

            // S·∫Øp x·∫øp
            filtered.sort((a, b) => {
                if (sortBy === 'value') {
                    return parseFloat(b.value.replace('$', '')) - parseFloat(a.value.replace('$', ''));
                } else {
                    return new Date(b.enddate) - new Date(a.enddate);
                }
            });

            // Ph√¢n trang
            const totalPages = Math.ceil(filtered.length / itemsPerPage);
            currentPage = Math.min(currentPage, totalPages);
            currentPage = Math.max(1, currentPage);

            const start = (currentPage - 1) * itemsPerPage;
            const paginatedItems = filtered.slice(start, start + itemsPerPage);

            displayAirdrops(paginatedItems);
            updatePagination(filtered.length);
        }

        function displayAirdrops(airdrops) {
            const container = document.getElementById('airdrop-list');
            container.innerHTML = '';

            if (airdrops.length === 0) {
                container.innerHTML = '<div class="no-results">Kh√¥ng t√¨m th·∫•y d·ª± √°n n√†o</div>';
                return;
            }

            airdrops.forEach(project => {
                const card = document.createElement('div');
                card.className = 'airdrop-card';
                card.innerHTML = `
                    <div class="window-header">
                        <span>${project.name}</span>
                        <div class="project-status ${project.status.toLowerCase()}">
                            <i>${project.status === 'Active' ? '‚ñ∂' : project.status === 'Upcoming' ? '‚è≥' : '‚èπ'}</i>
                            ${project.status}
                        </div>
                    </div>
                    <div class="window-content">
                        <div class="project-logo">
                            <img src="${project.logo}" alt="${project.name}" onerror="this.src='default-logo.png'">
                        </div>
                        <div class="project-info">
                            <div class="info-tag">
                                <i>üí∞</i>
                                <span class="project-value">${project.value}</span>
                            </div>
                            <div class="info-tag">
                                <i>üìÖ</i>
                                <span class="project-date">${project.enddate}</span>
                            </div>
                            <div class="info-tag">
                                <i>üìã</i>
                                <span class="project-requirements">${project.requirements}</span>
                            </div>
                        </div>
                        <div class="project-desc">${project.description}</div>
                        <a href="${project.link}" target="_blank" class="retro-button">Tham gia</a>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function updatePagination(totalItems) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            document.getElementById('pageInfo').textContent = 
                `Trang ${currentPage} / ${totalPages}`;
        }

        function changePage(delta) {
            currentPage += delta;
            filterAirdrops();
        }

        // Th√™m h√†m ƒë·ªÉ hi·ªÉn th·ªã loading
        function showLoading() {
            document.getElementById('airdrop-list').innerHTML = `
                <div class="loading">
                    <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
                </div>`;
        }

        // C·∫≠p nh·∫≠t event listener
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Trang ƒë√£ load xong');
            
            // Th√™m event listeners cho c√°c controls
            document.getElementById('statusFilter').addEventListener('change', filterAirdrops);
            document.getElementById('sortBy').addEventListener('change', filterAirdrops);
            document.getElementById('searchInput').addEventListener('input', filterAirdrops);
            
            // Hi·ªÉn th·ªã loading v√† load d·ªØ li·ªáu
            showLoading();
            loadAirdrops();
        });

        function showAirdropContent(status = 'all') {
            console.log('Hi·ªÉn th·ªã airdrop v·ªõi tr·∫°ng th√°i:', status);
            
            // Hi·ªÉn th·ªã section airdrop
            const sections = document.getElementsByClassName('content-section');
            for (let section of sections) {
                section.style.display = 'none';
            }
            
            const airdropContent = document.getElementById('airdrop-content');
            airdropContent.style.display = 'block';
            
            // C·∫≠p nh·∫≠t filter
            document.getElementById('statusFilter').value = status;
            
            // Load d·ªØ li·ªáu n·∫øu ch∆∞a c√≥
            if (allAirdrops.length === 0) {
                loadAirdrops();
            } else {
                filterAirdrops();
            }
            
            // ƒê√≥ng submenu
            closeAllSubmenus();
        }
    </script>
</body>
</html> 